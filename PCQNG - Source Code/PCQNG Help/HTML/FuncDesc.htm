<html>
	<head>
		<meta http-equiv="Content-Language" content="en-us">
		<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
		<meta name="ProgId" content="FrontPage.Editor.Document">
		<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
		<title>Functional Description</title>
	</head>
	<body>
		<table border="1" cellspacing="0" style="border-collapse: collapse" bordercolor="#111111" width="100%" id="AutoNumber1" cellpadding="4" bgcolor="#E1E1E1">
			<tr>
				<td width="100%"><font size="5"><b>Functional Description</b></font></td>
			</tr>
		</table>
		<table>
			<tr>
				<td>&nbsp;</td>
			</tr>
			<tr>
				<td>
					<p align="left"><font size="2">The ComScire PCQNG True Random Number Generator (TRNG) 
							represents a quantum leap forward in the production of high quality, True or 
							Quasirandom (algorithmically extended) numbers for use on your Personal 
							Computer.&nbsp; The PCQNG&nbsp; extracts the True Physical Entropy being 
							constantly generated by hardware already present in your PC to produce a 
							continuous, high-speed stream of virtually perfect random numbers containing 
							one bit of actual entropy per output bit.&nbsp; The generator's output is made 
							easily available through the PCQNG software in a number of user selectable 
							modes.</font></p>
					<p align="left"><font size="2">Many suggestions have been made for possible methods of 
							obtaining entropy from personal computers.&nbsp; These include keyboard timing 
							or intervals, following mouse movements and timing, and air turbulence in hard 
							drives.&nbsp; There have also been many vague ideas of using the various timing 
							signals from subsystems in the PC, such as the BIOS clock, the serial card and 
							the real time clock.&nbsp; In addition to these are the progressively more 
							restrictive ideas that require certain additional hardware to be attached to 
							your computer.&nbsp; These include measuring ping response time on computers 
							which are networked, digitizing static from a radio receiver through the sound 
							card, and finally, even using digitized images of Lava Lamps.</font></p>
					<p align="left"><font size="2">All these ideas suffer from one or more limitation or 
							theoretical flaw which have made them virtually unusable as practical sources 
							of random numbers.&nbsp; The most serious defect in all the methods proposed is 
							that there is no theoretical basis for precisely quantifying the actual entropy 
							content of the output sequence.&nbsp; There is usually no acceptable&nbsp; 
							method of predicting, or even measuring the statistical properties of those 
							sequences within necessary confidence levels.&nbsp; The output bit rate is 
							sometimes measured in bits per minute and some of the methods require the 
							active, physical participation of the PC user (you) to produce any output at 
							all.</font></p>
					<p align="left"><font size="2">The specific implementation of the ComScire PCQNG 2.0 
							will be described with reference to the following Block Diagram:</font></p>
					<p align="center">
						<img border="0" src="DescImages/PCQNG_BlockDiag.png" width="384" height="206"></p>
					<p align="left"><font size="2">The fundamental source of entropy in the PCQNG is the 
							same as in virtually all types of TRNG devices.&nbsp; These devices consist of 
							two distinct parts:&nbsp; one is a fluctuating signal source having an 
							unpredictable temporal evolution; the second is a periodic signal, causally 
							independent of the first signal, that is used to generate a timing sequence for 
							sampling the first signal.</font></p>
					<p><span style="font-size: 10pt">The possible exception to this is a purely 
    quantum mechanical device using superposition or entangled states and the 
    collapse of their wave function at a detector.&nbsp; Another generator that is 
    believed to be random is the purely mechanical generator, such as the type 
    used for most lottery drawings.&nbsp; Mechanical generators rely solely on 
    complex initial conditions and chaotic transformations to produce the 
    appearance of randomness.&nbsp; Precise quantification of bias in such a system
    </span><span style="FONT-SIZE: 10pt">is probably not possible due to changes 
    in the mechanical components over time, although there is reason enough to 
    believe that bias will exist.&nbsp; These drawing machines produce almost no true 
    entropy.</span>&nbsp;</p>
					<p><span style="FONT-SIZE: 10pt">Referring to the Block Diagram of the PCQNG, 
    a low-frequency sampling signal is derived by dividing the reference 
    oscillator signal to ultimately produce an interrupt (IRQ1) that, in turn, 
    causes the CPU to read a count of its core clock (Time Stamp Counter), and 
    send the instantaneous count to the PCQNG program.&nbsp; This happens at a rate 
    of about 1000Hz in a single processor and 1024Hz in a multi-processor 
    system.&nbsp; Note that in a multi-processor system, the interrupt is derived 
    from the Real-Time Clock (RTC) on IRQ8.&nbsp; Multi-processor systems will 
    therefore produce a slightly higher true entropy rate than is predicted for 
    a single-processor system.&nbsp; Although the CPU clock is ultimately derived 
    from the reference clock, there are at least two levels of Phase-Locked Loop 
    (PLL) frequency multiplication that raise t</span><span style="font-size: 10pt">he 
    original 14.318MHz to the typical 1-</span><span style="FONT-SIZE: 10pt"> 
    3GHz core frequency</span><span style="font-size: 10pt">.&nbsp;&nbsp; The CPU clock 
    will contain independent noise components that are produced by thermal and 
    shot noise and power supply noise in each of the PLL frequency 
    multipliers.&nbsp;&nbsp;</span></p>
					<p><span style="FONT-SIZE: 10pt">The reference oscillator is used to produce 
    several clocks used by the computer: a BIOS clock (1.193182MHz), a FSB or 
    bus clock (66.67MHz upward in integers multiples 33.33MHz) and numerous 
    others for use on the PCI bus, ISA bus, USB, serial port, key board, etc.&nbsp; 
    These are not directly used by the PCQNG.</span></p>
					<p align="left"><font size="2">To obtain an accurate calculation of the total,&nbsp; 
							true entropy available requires an accurate value of the total rms 
							cycle-to-cycle clock jitter in the CPU's core clock, as well as the 
							distribution of the jitter.&nbsp; This distribution closely approximates 
							Gaussian, as obtained by direct measurement, with little loss of 
							accuracy.&nbsp; The total rms jitter may be estimated by a combination of 
							measurements and theoretical calculations, or it may be obtained by direct 
							measurement.</font>
					</p>
					<p align="left"><font size="2">The estimation of the total rms jitter in the core clock 
							will be simplified for purposes of this description.&nbsp; The jitter in the 
							low-frequency sampling signal is assumed to be zero, although this is not 
							effectively true due to additional variance being introduced by completion of 
							the CPU's execution of the current instruction at the time the interrupt 
							arrives.&nbsp; Also, the jitter produced by the bus multiplier (core clock 
							multiplier) will also be assumed to be zero.&nbsp; Again, there is some 
							additional jitter produced in this second PLL multiplier, although it is 
							constrained to track the average bus phase fairly closely.&nbsp;&nbsp; In 
							addition, most newer clock synthesizers utilize spread-spectrum timing (SST) to 
							minimize radio frequency interference (RFI).&nbsp; SST is a frequency 
							modulation imposed on the bus clock with a modulation frequency of 33-50KHz and 
							a frequency deviation of 0.5-2%.&nbsp; Although SST is not yet universal, 
							current trends indicate it soon will be.&nbsp; Because all computers which may 
							run the PCQNG do not use SST, this additional source of jitter is not included 
							in the present analysis.</font>
					</p>
					<p align="left"><font size="2">Finally, with these simplifications the entire source of 
							jitter will be considered to arise in the first PLL multiplier that raises the 
							14.318MHz reference frequency to the bus frequency of 100-400MHz (in 
							2003).&nbsp; Specification sheets for both Cypress and Intel clock synthesizers 
							show maximum cycle-to-cycle jitter in the bus clock to be 200-250ps rms.&nbsp; 
							A maximum value specification is usually about twice the typical value 
							specification, yielding a probable average value of 100ps rms.&nbsp; This 
							cycle-to-cycle rms value must now be converted to a total rms jitter spanning 
							the approximately 1ms sampling period. This is done by calculating the number 
							of high-frequnecy cycles that span the sampling period, taking the square-root 
							of this number and then multiplying the result by the cycle-to-cycle value. Far 
							a comprehensive analysis of PLL jitter see <a href="http://www.designers-guide.com/Analysis/PLLjitter.pdf">
								<i>Modeling Jitter in PLL-based Frequency Synthesizers.</i> (Kundert, 2003)</a></font></p>
					<p align="left"><font size="2">Although the jitter is measured by reading the core 
							clock counter, the core frequency is not actually available in any system using 
							interrupts to read the counter.&nbsp; This is a result of the sequence of 
							events caused by a hardware interrupt:&nbsp; First a level shift or pulse is 
							sent to the programmable interrupt controller (PIC).&nbsp; The PIC checks for 
							other pending interrupts and their priorities.&nbsp; Then the PIC signals the 
							CPU that there is a pending interrupt.&nbsp; The CPU responds by requesting an 
							interrupt vector from the PIC which points to the location of the appropriate 
							interrupt service routine.&nbsp; The interrupt vector is sent to the CPU over 
							the bus, and no matter what the core frequency or when the interrupt actually 
							arrives, the CPU cannot begin the interrupt service routine (ISR) until the 
							next cycle of the bus clock.&nbsp; This sequence of events produces a time 
							quantization with an effective rate of&nbsp; 33.33MHz on all recent PC's.&nbsp;</font></p>
					<p align="left"><font size="2">Taking this measurement quantization into account: 
							33.33x10^6 times 0.001= 33.33x10^3.&nbsp; The square-root of this number of 
							cycles is 182.6 times 100ps yielding a total jitter of 18.26ns rms:&nbsp; the 
							cumulative jitter spanning each sampling period.&nbsp; This is equal to 0.609 
							cycles of the 33.33MHz quantization frequency and will be called the normalized 
							jitter.&nbsp; There is no difference in the resulting entropy calculation which 
							signal is considered to contain the jitter.</font></p>
					<p align="left"><font size="2"><a href="HCalc.htm">Calculating the entropy</a> is a 
							straight-forward numerical procedure once the normalized jitter is 
							determined.&nbsp; The algorithm first calculates the probability of actually 
							finding a high value in the sampled signal where one is expected.&nbsp; This is 
							most easily done by assigning the jitter to the lower frequency (LF) signal and 
							then integrating the probability distribution function (PDF) across all time 
							periods where the PDF overlaps the high state of the higher frequency (HF) 
							signal.&nbsp;&nbsp; The PDF is centered around the rising edge of the LF 
							signal, and in this case the distribution is Gaussian with standard deviation 
							equal to the normalized rms jitter.&nbsp; The integration is repeated over a 
							large number of equally spaced points exactly spanning one high state, or half 
							cycle, of the HF signal.&nbsp;&nbsp; These results are then averaged.&nbsp;</font>
					</p>
					<p align="left"><font size="2">This result will represent the true average if the ratio 
							of the HF to LF frequency is an irrational number.&nbsp; In that case, the 
							rising edge of the LF signal will appear uniformly in all phases of the HF 
							signal; an assumption of the algorithm.&nbsp; The actual HF to LF ratio, in 
							conjunction with the size of the normalized jitter, yields results 
							indistinguishable from those expected from this assumption.&nbsp; HF to LF 
							ratios which are integers or contain rational fractions may produce 
							significantly different results, especially when the normalized jitter is 
							small.</font>
					</p>
					<p align="left"><font size="2">The true entropy may now be directly calculated from the 
							probability of predicting a high state or &quot;1&quot;, p(1), and the 
							probability of predicting a low state or &quot;0&quot;, which is just p(0) = 
							1-p(1).&nbsp; These two probabilities are used in Shannon's entropy equation:</font>
					</p>
					<p align="left"><font size="2"> <img src="DescImages/ShannonEqu.gif" border="0" width="259" height="45"></font></p>
					<p align="left"><font size="2">The Table 1 was calculated using various normalized rms 
							jitter values:</font></p>
					<center>
						<table cellPadding="5" width="17%" border="1">
							<tr>
								<td align="middle" width="50%">
									<p align="left"><font size="2">JITTER</font>
								</td>
								<td align="middle" width="50%">
									<p align="left"><font size="2">ENTROPY</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.5</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.99998</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.4</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.9991</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.3</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.9864</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.2</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.8999</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.1</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.6333</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.05</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.4014</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.02</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.2039</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.01</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.1180</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.005</font>
								</td>
								<td align="middle" width="50%">
									<p align="center"><font size="2">.0667</font>
								</td>
							</tr>
						</table>
					</center>
					<p align="center"><b><font size="2">TABLE 1</font></b>
					</p>
					<p align="left"><font size="2">It has been determined theoretically and empirically 
							that when the LF signal is sampling a multi-bit binary counter, counting the 
							cycles of the HF signal, each successively more significant bit effectively 
							contains just one-half the normalized jitter of the previous bit.&nbsp; In our 
							example, the LSB has a normalized jitter of 0.609.&nbsp; This would result in 
							an entropy of almost exactly 1.000.&nbsp; If only the one bit were used, the 
							rest of the entropy would be wasted.&nbsp; The next more significant bit would 
							contain a normalized jitter of 0.305, representing an entropy of 0.98.&nbsp; 
							Table 2 shows the entropy contained in each of the 8 lower bits:</font></p>
					<center>
						<table width="26%" border="1">
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">BIT</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">JITTER</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">ENTROPY</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">0</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.609</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">1.0</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">1</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">&nbsp;.305</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.98</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">2</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">&nbsp;.152</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.80</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">3</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.076</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.53</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">4</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.038</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.34</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">5</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.019</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.20</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">6</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.010</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.11</font>
								</td>
							</tr>
							<tr>
								<td align="middle" width="33%">
									<p align="center"><font size="2">7</font>
								</td>
								<td align="middle" width="33%">
									<p align="center"><font size="2">.005</font>
								</td>
								<td align="middle" width="34%">
									<p align="center"><font size="2">.06</font>
								</td>
							</tr>
						</table>
					</center>
					<p align="center"><b><font size="2">TABLE 2</font></b>
					</p>
					<p align="left"><font size="2">The total true entropy available in the 8 LSB's is 4.0 
							bits.&nbsp; This result is obtained for a sample rate of 1000Hz, which yields a 
							final entropy rate of about 4Kbits/second.&nbsp; Even using a more conservative 
							jitter value of 50ps (instead of 100ps) results in a calculated entropy rate of 
							3Kbits/second, while actual measurements on Intel- and AMD-based PC's from 
							133MHz to 1.7GHz&nbsp; typically yield 5-6Kbits/second.&nbsp; The somewhat 
							higher measured entropy is due to the additional jitter sources that were 
							disregarded in this simplified estimate.&nbsp; Results from PC's with higher 
							CPU core frequencies - above 1GHz - will generally produce progressively higher 
							measured entropy rates; some approaching a maximum of nearly 8Kbps.&nbsp; 
							Measurements of the actual (Gaussian) probability distribution function of the 
							sampled data indicate that entropy rates above about 5Kbps are due to chaotic 
							sources rather than true entropy.&nbsp; That is, jitter caused by interactions 
							of the interrupt timing with the Windows OS, as well as with the various 
							instruction completion times in the CPU.&nbsp; It is highly unlikely that the 
							chaotic processes of one computer could be duplicated in any other computer; 
							however, no chaotic process can be considered to produce true entropy.</font>
					</p>
					<p align="left"><font size="2">It is essential to understand the theoretical source and 
							magnitude of the entropic process used for producing any true RNG.&nbsp; For 
							illustrative purposes one might consider, as has been suggested elsewhere, 
							using the BIOS clock and the RTC as a source of random bits.&nbsp; The 
							1.19318MHz BIOS clock is derived by dividing the 14.318MHz reference clock by 
							12.&nbsp; This will result in a cycle-to-cycle jitter of 70ps*SQRT(12) = 242ps 
							rms (based on the typical jitter of the reference oscillator).&nbsp; At a 
							sampling rate of 16Hz the normalized jitter is 0.0789 and the calculated 
							entropy is 1.31 bits per sample, yielding a total entropy rate of just 
							21bits/second.&nbsp;</font></p>
					<p align="left"><font size="2">The raw core clock counter values are processed by the 
							PCQNG software to isolate and extract the bits containing the true 
							entropy.&nbsp; This is simply the lower 8 bits after adjusting for the 33.33Mhz 
							quantization.&nbsp; A special mode allows the raw bits to be directly accessed 
							for confirmation of their entropy content and statistical properties; or, they 
							may be processed by the user's preferred methods.&nbsp; These bits are further 
							processed in one of two ways, depending on their intended use:</font>
					</p>
					<p align="left"><font size="2">1) Eight entropy-containing bits per sample are sent 
							bit-wise through a very powerful statistical stirring program which mixes the 
							entropy in the output bits and corrects any statistical defect without changing 
							the total entropy content.&nbsp; The output bits are then assembled into 8-bit 
							words and sent word-wise through another stage of statistical stirring.&nbsp; 
							The final output bit-rate is selectable through mode settings which allow a 
							range of output rates from 1bit in 8 samples to 32 bits per sample.&nbsp; 
							Output rates at or below the actual available entropy rate (about 4Kbps) ensure 
							true randomness: output rates above the true entropy rate are produced by 
							&quot;stretching&quot; the available entropy in the stirring functions while 
							still maintaining virtually perfect statistical properties.&nbsp; Since the 
							higher bit rates are derived from stretching a continuous stream of true random 
							bits, there is no limiting period and a constantly changing seed, making 
							cryptographic attack prohibitively expensive.<br>
							2) Eight entropy-containing bits per sample are sent bit-wise through a minimal 
							statistical stirring program which mixes the entropy in the output bits and 
							corrects statistical defects without reducing their true entropy.&nbsp; These 
							eight bits are exclusive-ored to produce a single output bit at a rate of 
							1000bits/second.&nbsp; These random event generator (REG) bits are intended for 
							special applications relating to direct mind-machine interaction (DMMI) and 
							other parapsychological experimentation.&nbsp; Decades of laboratory testing 
							and subsequent meta-analyses indicate a small but persistent effect on the 
							statistical properties of true random generators in response to operator 
							intention.&nbsp; The statistical properties of REG-mode bits - in the absence 
							of operator intention - are calculated by a combination of theoretical and 
							empirical methods to deviate from perfect randomness by less than 5ppm in both 
							1/0 balance and autocorrelation.&nbsp;</font>
						<br>
						&nbsp;</p>
					<p align="center"><b><font size="2">TESTING THE PCQNG</font></b>
					</p>
					<p align="left"><font size="2">The PCQNG has been tested extensively by well-known 
							programs such as Marsaglia's DIEHARD suite of tests and most of NIST's new 
							tests.&nbsp; ComScire's tests (ComScire RNGmeter), which are more stringent 
							than either of these, have also been applied to bit counts up to 10 
							billion.&nbsp; The PCQNG has not failed any test for randomness.&nbsp; All 
							other generators we have tested fail ComScire's tests, with the exception of 
							one type of pseudorandom generator.</font>
					</p>
					<p align="left"><font size="2">REG bits have been tested directly only to 100 million 
							bits due to their much lower bit-rate.&nbsp; The final statistical properties 
							of REG bits are determined by measuring the bias and autocorrelation of bits 
							derived from smaller blocks of samples and applying known equations for 
							calculating the resulting properties of groups of bits which are 
							exclusive-ored.</font>
					</p>
					<p align="left"><font size="2">The ComScire RNGmeter is now available as a general 
							testing program including a detailed description of its tests.</font></p>
					<p align="left"><font size="2">NOTE:&nbsp; The PCQNG must be run on a fifth generation 
							(Pentium class) or higher computer because the core clock counter was not 
							available in earlier CPU's.&nbsp; PCQNG 2.0 will run in 
							Windows98/ME/XP/2000/2003&nbsp; (Not for WindowsNT/95).</font></p>
					<p align="left"><font size="2">ComScire is a registered trademark of The Quantum World 
							Corporation.&nbsp; Windows is a registered trademark of Microsoft 
							Corporation.&nbsp; Pentium and Intel are registered trademarks of Intel 
							Corporation.&nbsp; All other trademarks are trademarks of their respective 
							owners.</font></p>
					<p align="left"><font size="2">The PCQNG™ is protected by copyright and patents 
							pending.&nbsp; © 2003 Quantum World Corporation.</font>
				</td>
			</tr>
		</table>
	</body>
</html>
